<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Gentallela Alela! | </title>

    <!-- Bootstrap -->
    <link href="/puls/inc//vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="/puls/inc//vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">

   <!-- Custom Theme Style -->
    <link href="/puls/inc/css/custom/custom.min.css" rel="stylesheet">
       <!-- PNotify -->
     <link href="/puls/inc/vendors/pnotify/dist/pnotify.css" rel="stylesheet">
    <link href="/puls/inc/vendors/pnotify/dist/pnotify.buttons.css" rel="stylesheet">
    <link href="/puls/inc/vendors/pnotify/dist/pnotify.nonblock.css" rel="stylesheet">
 </head>

  <body class="nav-md">
    <div class="container body">
      <div class="main_container">
        <div class="col-md-3 left_col">
          <div class="left_col scroll-view">
            <div class="navbar nav_title" style="border: 0;">
              <a href="index.html" class="site_title"><i class="fa fa-paw"></i> <span>Gentellela Alela!</span></a>
            </div>

            <div class="clearfix"></div>

            <!-- menu profile quick info -->
            <div class="profile">
              <div class="profile_pic">
                <img src="{{urlPict}}" alt="..." class="img-circle profile_img">
              </div>
              <div class="profile_info">
                <span>Welcome,</span>
                <h2>{{nom}} {{prenom}} </h2>
              </div>
            </div>
            <!-- /menu profile quick info -->

            <br />

         <!-- sidebar menu -->
            <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
        {{#each section}}

    <!-- Here the context is each individual person. So we can access its properties directly: -->
        <div class="menu_section">
                <h3>{{title}}</h3>
               <ul class="nav side-menu"> 
                {{#each menu}}
               <li id="menu"><a><i class="{{classe}}"></i> {{title}} <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                    {{#each sousmenu}}
                      <li id="url"><a href="{{template}}" onclick="return false;">{{title}}</a></li>
                      
                    {{/each}}
                    </ul>
                  </li>
               {{/each}}   
               </ul>
               
              </div>
{{/each}}  
            </div> 
            <!-- /sidebar menu -->

            <!-- /menu footer buttons -->
            <div class="sidebar-footer hidden-small">
              <a data-toggle="tooltip" data-placement="top" title="Settings">
                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Lock">
                <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Logout">
                <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
              </a>
            </div>
            <!-- /menu footer buttons -->
          </div>
        </div>

        <!-- top navigation -->
        <div class="top_nav">
          <div class="nav_menu">
            <nav class="" role="navigation">
              <div class="nav toggle">
                <a id="menu_toggle"><i class="fa fa-bars"></i></a>
              </div>

              <ul class="nav navbar-nav navbar-right">
                <li class="">
                  <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <img src="{{urlPict}}" alt="">John Doe
                    <span class=" fa fa-angle-down"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-usermenu pull-right">
                    <li><a href="javascript:;"> Profile</a></li>
                    <li>
                      <a href="javascript:;">
                        <span class="badge bg-red pull-right">50%</span>
                        <span>Settings</span>
                      </a>
                    </li>
                    <li><a href="javascript:;">Help</a></li>
                    <li><a href="/puls/web/login/logout"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                  </ul>
                </li>

                <li role="presentation" class="dropdown">
                  <a href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                    <i class="fa fa-envelope-o"></i>
                    <span class="badge bg-green">6</span>
                  </a>
                  <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                    <li>
                      <a>
                        <span class="image"><img src="{{urlPict}}" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="{{urlPict}}" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="{{urlPict}}" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="{{urlPict}}" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <div class="text-center">
                        <a>
                          <strong>See All Alerts</strong>
                          <i class="fa fa-angle-right"></i>
                        </a>
                      </div>
                    </li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <!-- /top navigation -->

        <!-- page content -->
        <div class="right_col" role="main">
          <div id="fountainG" aria-hidden="true">
	<div id="fountainG_1" class="fountainG"></div>
	<div id="fountainG_2" class="fountainG"></div>
	<div id="fountainG_3" class="fountainG"></div>
	<div id="fountainG_4" class="fountainG"></div>
	<div id="fountainG_5" class="fountainG"></div>
	<div id="fountainG_6" class="fountainG"></div>
	<div id="fountainG_7" class="fountainG"></div>
	<div id="fountainG_8" class="fountainG"></div>
</div>
        </div>
        <!-- /page content -->

        <!-- footer content -->
        <footer>
          <div class="pull-right">
            Gentelella - Bootstrap Admin Template by <a href="https://colorlib.com">Colorlib</a>
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>
    
<script data-main="app/config" type="text/javascript" src="assets/libs/require/require-2.1.18.min.js"></script>
    <!-- jQuery -->
    <script src="/puls/inc/vendors/jquery/dist/jquery.min.js"></script>
     <script src="/puls/inc/js/standard/underscore-min.js"></script>  
     <!-- Backbone -->
    <script src="/puls/inc/js/standard/backbone-min.js"></script>
    <!-- Bootstrap -->
    <script src="/puls/inc/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="/puls/inc/vendors/raphael/raphael.min.js"></script>
    <!-- NProgress -->
    <script src="/puls/inc/vendors/nprogress/nprogress.js"></script>
    
 <!-- Custom Theme Scripts -->
    <script src="/puls/inc/js/custom/custom.min.js"></script>
     
     <!-- pnotify.js -->
    <script src="/puls/inc/vendors/pnotify/dist/pnotify.js"></script>
     <!-- Dropzone.js -->
   <!--  <script src="/puls/inc/vendors/dropzone/dist/min/dropzone.min.js"></script> -->
    <script type="text/javascript">
    //default javascript include in main page
 
    //à externaliser
   var presentScript = new Array("vendors/jquery/dist/jquery.min.js",
		            "js/standard/underscore-min.js",
		            "js/standard/backbone-min.js",
		            "vendors/bootstrap/dist/js/bootstrap.min.js",
		            "vendors/fastclick/lib/fastclick.js",
		            "vendors/nprogress/nprogress.js",
		            "/js/custom/custom.min.js",
		            "/vendors/pnotify/dist/pnotify.js");
		  
  var scriptPage= new Map();
  var callBack= new Map();

scriptPage.set("cloud",new Array("vendors/dropzone/dist/min/dropzone.min.js"));
scriptPage.set("Dashboard3",new Array("vendors/dropzone/dist/min/dropzone.min.js",
		                              "vendors/raphael/raphael.min.js",
		                              "vendors/morris.js/morris.min.js",
		                              "vendors/bootstrap-progressbar/bootstrap-progressbar.min.js",
		                              "vendors/jquery.tagsinput/src/jquery.tagsinput.js",
		                              "vendors/select2/dist/js/select2.full.min.js",
		                              "js/standard/moment/moment.min.js",
		                              "js/standard/datepicker/daterangepicker.js",
		                              "vendors/dropzone/dist/min/dropzone.min.js"));

callBack.set("cloud",function() {
	try{
	debugger;if(window.Dropzone.instances.length==0){debugger; window.Dropzone._autoDiscoverFunction();}  	
	}catch(ex){
    //ignore
	}
	});
	
callBack.set("Dashboard3",function() {
	try{
	debugger;if(window.Dropzone.instances.length==0){debugger; window.Dropzone._autoDiscoverFunction();}  	
	}catch(ex){
    //ignore
	}
	});
 

var app = app || {};


app.BodyNav = Backbone.View.extend({
id:'001BodyNav'
,
	  //tagName:  'div',
	  el: '#sidebar-menu', 
	  // Cache the template function for a single item.

	  events: {
	   
	   
	    'click #url': 'change_menu'
	  },

	  initialize: function (options) {
		  
		  
	    // In Backbone 1.1.0, if you want to access passed options in
	    // your view, you will need to save them as follows:
	    this.loadPage("{{currentpage}}");
	    this.options = options || {};
	   // this.listenTo(app.Todos, 'reset', this.render);
	    //this.listenTo(this.model, 'change', this.render);
	    
	    console.log(this.model);
	    
	  },

	  // Re-render the title of the todo item.
	  render: function() {
		  this.$el.html("jai changé");
	    return this;
	  },

	  activeMenu: function() {
		  
	
		  
	  },
	  change_menu:function(e) {
		  
		  var target =  $(e.currentTarget);
		   
		  var myUrl=target.children().attr("href") 
		  e.stopImmediatePropagation();
		  if($('li[id="urlOn"]'))
			  {
			  $('li[id="urlOn"]').attr('class','');
			  }
		 
		  if($('li[class="current-page"]'))
			  {
			  $('li[class="current-page"]').attr('class','');
			  }
		  $('li[id="urlOn"]').attr('id', 'url');
		  target.attr('id', 'urlOn');
		  this.loadPage(myUrl);
	  },
	  close: function() {
	    // executed when todo loses focus
		  this.$el.html("jai changé");
	  },
	  
	  loadJavaScript:function(myUrl){
		  
		var scriptToLoad=scriptPage.get(myUrl);
		if(scriptToLoad)
			{
			var that=this;
			 scriptToLoad.forEach(function(element) {
				  try{
					  
				 if(!presentScript.includes(element)){
					 presentScript[presentScript.length]=element;
					 that.addScriptToPage(element,callBack.get(myUrl));
					      
				 }
				  }catch(e) //iphone support
				  {
					  presentScript.forEach(function(element2)
					  {
						  if(!element===element2){
								 presentScript[presentScript.length]=element;
								 that.addScriptToPage(element,callBack.get(myUrl));
								      
							 }
						  
					  })
				  }
				 
				 
				})
			}
			
			
			
			
			
	  }
	  ,
	  addScriptToPage:function(scriptUrl,callback){
		 
		  var script = document.createElement("script")
		    script.type = "text/javascript";

		    if (script.readyState){  //IE
		        script.onreadystatechange = function(){
		            if (script.readyState == "loaded" ||
		                    script.readyState == "complete"){
		                script.onreadystatechange = null;
		                console.log("script "+ scriptUrl+" loaded");
		                
		               
		            }
		        };
		    } else {  //Others
		        script.onload = function(){
		        	console.log("script "+ scriptUrl+" loaded");
		        	
		        };
		    }

		    script.src ='/puls/inc/'+scriptUrl;
		    document.body.appendChild(script);
	  }
	  ,
	  loadPage:function(myUrl)
	  {
		  window.history.replaceState( {} , myUrl, myUrl );
		  this.loadJavaScript(myUrl);
		  var that=this;
	  	$.ajax({
	  	       url : myUrl, // La ressource ciblée
	  	       type : 'GET', // Le type de la requête HTTP. 
	  	        dataType: "html",
	  	        async: true,
	  	      data: 'currentPage=' + myUrl,
	  	   contentType: "application/x-www-form-urlencoded",
	  	      success : function(code_html, statut){ // code_html contient le HTML renvoyé
	  	    	  
	  	    	
	  	    	  $('div[role="main"]').html(code_html);
	  	    	if($(document).width() <992 )
	  	    	{
	  	    		that.$('ul[style="display: block;"]').attr('style','display: none;');
                    that.$('li[class="active"]').attr('class','active-sm');
	  	    	  //Do Something
	  	    	}
	  	    	if(callBack.get(myUrl))
	  	    		callBack.get(myUrl)();
	  	        },
	  	    error : function(resultat, statut, erreur){
	  	    	new PNotify({
	           title: 'Wrong menu!',
	           text: 'the menu '+ myUrl +' don\'t exist',
	           type: 'error',
	           styling: 'bootstrap3'
	       });
	  	       },
	  	        complete : function(resultat, statut){
	  	        	
	  	        	
	  		    	
	  	        }
	  	    });
	    
	  }
	
	});
	
	

	

// sends HTTP GET to /todos

var todoView2 = new app.BodyNav();


</script>
  </body>
</html>
